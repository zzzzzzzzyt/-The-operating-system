# 计算机网络查漏补缺



# 基础篇

## 2.1 TCP/IP 网络模型有哪几层？

综上所述，TCP/IP 网络通常是由上到下分成 4 层，分别是**应用层，传输层，网络层和网络接口层**。

![Snipaste_2022-05-12_08-50-52.png](https://s2.loli.net/2022/05/12/yImHaC8PqThAZJz.png)

再给大家贴一下每一层的封装格式：

![Snipaste_2022-05-12_08-51-02.png](https://s2.loli.net/2022/05/12/3CeGZv8xRBzbUj4.png)

网络接口层的传输单位是帧（frame），IP 层的传输单位是包（packet），TCP 层的传输单位是段（segment），HTTP 的传输单位则是消息或报文（message）。但这些名词并没有什么本质的区分，可以统称为数据包。



## 2.2 键入网址到网页显示，期间发生了什么？





## 2.3 Linux 系统是如何收发网络包的？

电脑与电脑之间通常都是通话网卡、交换机、路由器等网络设备连接到一起，那由于网络设备的异构性，国际标准化组织定义了一个七层的 OSI 网络模型，但是这个模型由于比较复杂，实际应用中并没有采用，而是采用了更为简化的 TCP/IP 模型，Linux 网络协议栈就是按照了该模型来实现的。

TCP/IP 模型主要分为应用层、传输层、网络层、网络接口层四层，每一层负责的职责都不同，这也是 Linux 网络协议栈主要构成部分。

当应用程序通过 Socket 接口发送数据包，数据包会被网络协议栈从上到下进行逐层处理后，才会被送到网卡队列中，随后由网卡将网络包发送出去。

而在接收网络包时，同样也要先经过网络协议栈从下到上的逐层处理，最后才会被送到应用程序。







# HTTP篇





# TCP篇







# IP篇

































# 自己记录的问题

- TCP/IP网络模型属于网络通信的一套通用的网络协议
- 应用层是工作在操作系统的用户态，传输层及以下则工作在内核态
- MSS（TCP最大报文段长度）
- 传输层的报文会携带端口号的，因此接收方可以识别出该报文是发送给哪个应用
- 网络层最常使用的是 IP 协议（*Internet Protocol*），IP 协议会将传输层的报文作为数据部分，再加上 IP 包头组装成 IP 报文，如果 IP 报文大小超过 MTU（以太网中一般为 1500 字节）就会**再次进行分片**，得到一个即将发送到网络的 IP 报文。
- IP地址主要分成两种意义，一个是网络号，一个是主机号，根据掩码可以获取两者
- **IP 协议的寻址作用是告诉我们去往下一个目的地==该朝哪个方向走==，路由则是==根据「下一个目的地」选择路径==。寻址更像在导航，路由更像在操作方向盘**。`自己用通俗的话讲一遍就是这个ip告诉我们最终要去哪个网络的哪台主机，路由的话就是咋去，遇到个路由器给他看，他帮你分配`
- 网络接口层会将网络层的数据封装成帧，根据mac头部进行转发
- ⭐其实我们访问对应的网址后面一系列的东西，其实最后都是请求他实际的域名的 比如`https://www.baidu.com/s?wd=杭州电子科技大学&rsv_spt=1&rsv_iqid=0xc992c3e7004b9c01&issp=1&f=8&rsv_bp=1&rsv_idx=2&ie=utf-8` 类似于这一段其实就是请求百度，后面是数据源的数据名，用来生成相应的请求报文发送给服务器域名进行请求
- 必须用到DNS因为委托操作系统发送消息的时候，必须提供通信对象的IP地址（浏览器中会有域名的缓存，每次都会先看是否有缓存，再去请求DNS）
- `MTU`：一个网络包的最大长度，以太网中一般为 `1500` 字节。
  `MSS`：除去 IP 和 TCP 头部之后，一个网络包所能容纳的 TCP 数据的最大长度。
- TCP报文的源端口随机生成，目的端口根据你的请求，如果是HTTP请求那就是80 如果是其他就是其他规定的端口
- TCP可靠传输 可以看看他的报文头部
- 搞清楚 包发给谁 查一下路由表，根据路由表获得的ip然后使用arp协议找到对应路由器的mac地址，操作系统也会有arp缓存 不是每次都要广播获取
- 在网络包传输的过程中，**源 IP 和目标 IP 始终是不会变的，一直变化的是 MAC 地址**，因为需要 MAC 地址在以太网内进行**两个设备**之间的包传输。
- 





























